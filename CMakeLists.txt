if(${CONFIG_IDF_TARGET_ESP8266})
set(SOURCES "revk.c" "jo.c" "lwmqtt.c" "esp8266_compat.c")
else()
set(SOURCES "revk.c" "jo.c" "lwmqtt.c")
endif()

if(EXISTS "../components/mdns")
idf_component_register(
			SRCS ${SOURCES}
			INCLUDE_DIRS "include"
			REQUIRES nvs_flash app_update esp_http_client esp-tls esp_http_server esp8266 spi_flash mdns
			EMBED_FILES "../../build/partition_table/partition-table.bin"
)
else()
idf_component_register(
			SRCS ${SOURCES}
			INCLUDE_DIRS "include"
			REQUIRES nvs_flash app_update esp_http_client esp-tls esp_http_server esp8266 spi_flash
			EMBED_FILES "../../build/partition_table/partition-table.bin"
)
endif()
add_definitions(-DBUILD_ESP32_USING_CMAKE)
set_property(SOURCE "../../build/partition_table/partition-table.bin" PROPERTY GENERATED 1)
